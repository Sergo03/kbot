name: KBOT-CICD

on: push

jobs:
  ci: 
      name: CI
      runs-on: ubuntu-latest

      steps:
        - name: Checkout
          uses: actions/checkout@v3
          with: 
            fetch-depth: 0
         
        - name: Run test
          run: make test  
        - name: "Auth to ghcr"
          uses: actions/labeler@v2
          with:
            repo-token: ${{ secrets.GITHUB_TOKEN }}
        - name: Build&Push
            APP: "kbot"
            REGISTRY: "ghcr.io"
          run: make image push
        
          
      